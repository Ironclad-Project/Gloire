diff --git util-ironclad-clean/meson.build util-ironclad-workdir/meson.build
index f55a32b..bad8ea6 100644
--- util-ironclad-clean/meson.build
+++ util-ironclad-workdir/meson.build
@@ -40,7 +40,7 @@ executable('newgrp', sources: files('src/newgrp.c'), include_directories: includ
 executable('pivot_root', sources: files('src/pivot_root.c'), include_directories: include_directories('src'), install: true)
 executable('ps', sources: files('src/ps.c'), include_directories: include_directories('src'), install: true)
 executable('renice', sources: files('src/renice.c'), include_directories: include_directories('src'), install: true)
-executable('showmem', sources: files('src/showmem.c'), include_directories: include_directories('src'), install: true)
+executable('showmem', sources: files('src/showmem.c'), include_directories: include_directories('src'), dependencies: meson.get_compiler('c').find_library('m'), install: true)
 executable('strace', sources: files('src/strace.c'), include_directories: include_directories('src'), install: true)
 executable('su', sources: files('src/su.c'), include_directories: include_directories('src'), install: true)
 executable('umount', sources: files('src/umount.c'), include_directories: include_directories('src'), install: true)
diff --git util-ironclad-clean/src/cpuinfo.c util-ironclad-workdir/src/cpuinfo.c
index 78c35f5..a953bad 100644
--- util-ironclad-clean/src/cpuinfo.c
+++ util-ironclad-workdir/src/cpuinfo.c
@@ -73,8 +73,7 @@ int main(int argc, char *argv[]) {
 
     // Fetch CPU information by using getcpuinfo.
     struct cpuinfo cpu;
-    int ret, errno;
-    SYSCALL1(SYSCALL_GETCPUINFO, &cpu);
+    long ret = syscall(SYS_getcpuinfo, &cpu);
     if (ret == -1) {
         perror("Could not get CPU information from the kernel");
         return 1;
diff --git util-ironclad-clean/src/dmesg.c util-ironclad-workdir/src/dmesg.c
index 9543227..53852c8 100644
--- util-ironclad-clean/src/dmesg.c
+++ util-ironclad-workdir/src/dmesg.c
@@ -45,8 +45,7 @@ int main(int argc, char *argv[]) {
 
     size_t length = 100 * 80;
     char *logs = malloc(length);
-    int ret, errno;
-    SYSCALL2(SYSCALL_DUMPLOGS, logs, length);
+    long ret = syscall(SYS_dumplogs, logs, length);
     if (ret == -1) {
         return 1;
     }
diff --git util-ironclad-clean/src/ifconfig.c util-ironclad-workdir/src/ifconfig.c
index fcb424a..2e65c4f 100644
--- util-ironclad-clean/src/ifconfig.c
+++ util-ironclad-workdir/src/ifconfig.c
@@ -106,7 +106,6 @@ int main(int argc, char *argv[]) {
     }
 
     if (do_block || do_unblock) {
-        int ret, errno;
         bool actually_block = !!do_block;
         char path[64];
         snprintf(path, 64, "/dev/%s", blocked);
@@ -115,13 +114,12 @@ int main(int argc, char *argv[]) {
             fprintf(stderr, "ifconfig: could not open %s for blocking\n", path);
             return 1;
         }
-        SYSCALL3(SYSCALL_CONFIG_NETINTER, fd, 1, &actually_block);
-        return errno;
+        long ret = syscall(SYS_config_netinter, fd, 1, &actually_block);
+        return ret == -1 ? 1 : 0;
     }
 
     struct netinterface *buffer = malloc(10 * sizeof(struct netinterface));
-    long ret, errno;
-    SYSCALL2(SYSCALL_LISTNETINTER, buffer, 10);
+    long ret = syscall(SYS_listnetinter, buffer, 10);
     if (ret == -1) {
         return 1;
     }
diff --git util-ironclad-clean/src/ipcs.c util-ironclad-workdir/src/ipcs.c
index 4fb98c4..4265153 100644
--- util-ironclad-clean/src/ipcs.c
+++ util-ironclad-workdir/src/ipcs.c
@@ -82,7 +82,7 @@ int main(int argc, char *argv[]) {
             "bytes", "nattach");
         for (int i = 1; i <= 20; i++) {
             if (!shmctl(i, IPC_STAT, &buf)) {
-                printf("%010d %5d %10d %10o %10zu %6ld\n", buf.shm_perm.__ipc_perm_key,
+                printf("%010d %5d %10d %10o %10zu %6ld\n", buf.shm_perm.__key,
                     i, buf.shm_perm.uid, buf.shm_perm.mode, buf.shm_segsz,
                     buf.shm_nattch);
             }
@@ -94,9 +94,8 @@ int main(int argc, char *argv[]) {
             puts("");
         }
 
-        int ret, errno;
         struct flockinfo *buffer = malloc(20 * sizeof(struct flockinfo));
-        SYSCALL2(SYSCALL_LISTFLOCKS, buffer, 20);
+        long ret = syscall(SYS_listflocks, buffer, 20);
         if (ret == -1) {
             return 1;
         }
diff --git util-ironclad-clean/src/login.c util-ironclad-workdir/src/login.c
index 0b1768e..f7add85 100644
--- util-ironclad-clean/src/login.c
+++ util-ironclad-workdir/src/login.c
@@ -124,12 +124,18 @@ int main(int argc, char *argv[]) {
             return 1;
         } else if (child == 0) {
             struct utmpx entry;
+            memset(&entry, 0, sizeof(entry));
             entry.ut_type = USER_PROCESS;
             strcpy(entry.ut_user, pwd->pw_name);
-            gettimeofday(&entry.ut_tv, NULL);
+            // glibc's ut_tv is __timeval32, not struct timeval
+            struct timeval tv;
+            gettimeofday(&tv, NULL);
+            entry.ut_tv.tv_sec = tv.tv_sec;
+            entry.ut_tv.tv_usec = tv.tv_usec;
             entry.ut_pid = login_pid;
-            strcpy(entry.ut_user, pwd->pw_name);
-            strcpy(entry.ut_line, tty);
+            if (tty != NULL) {
+                strncpy(entry.ut_line, tty, sizeof(entry.ut_line) - 1);
+            }
             entry.ut_id[0] = '\0';
 
             setutxent();
diff --git util-ironclad-clean/src/lsblk.c util-ironclad-workdir/src/lsblk.c
index defaca3..3286fcc 100644
--- util-ironclad-clean/src/lsblk.c
+++ util-ironclad-workdir/src/lsblk.c
@@ -69,9 +69,8 @@ static const char *to_human_size(uint64_t bytes) {
 }
 
 static const char *get_mountpoint(const char *dev_name) {
-    long ret, errno;
     struct mountinfo *buffer = malloc(5 * sizeof(struct mountinfo));
-    SYSCALL2(SYSCALL_LISTMOUNTS, buffer, 5);
+    long ret = syscall(SYS_listmounts, buffer, 5);
     if (ret == -1 || ret > 5) {
         return NULL;
     }
diff --git util-ironclad-clean/src/mount.c util-ironclad-workdir/src/mount.c
index 7525b79..1668015 100644
--- util-ironclad-clean/src/mount.c
+++ util-ironclad-workdir/src/mount.c
@@ -30,7 +30,7 @@
 #include <sys/ioctl.h>
 #include <fcntl.h>
 #include <libgen.h>
-#include <asm/ioctls.h>
+/* DEV_PARTUUID is defined in bits/ioctls.h */
 
 struct mountinfo {
     uint32_t type;
@@ -80,10 +80,10 @@ static char *type_to_string(int type) {
    }
 }
 
+
 static int update_mtab(void) {
-    long ret, errno;
     struct mountinfo *buffer = malloc(5 * sizeof(struct mountinfo));
-    SYSCALL2(SYSCALL_LISTMOUNTS, buffer, 5);
+    long ret = syscall(SYS_listmounts, buffer, 5);
     if (ret == -1 || ret > 5) {
         return 1;
     }
@@ -114,9 +114,8 @@ static int update_mtab(void) {
 }
 
 static int print_kernel_mounts(void) {
-    long ret, errno;
     struct mountinfo *buffer = malloc(5 * sizeof(struct mountinfo));
-    SYSCALL2(SYSCALL_LISTMOUNTS, buffer, 5);
+    long ret = syscall(SYS_listmounts, buffer, 5);
     if (ret == -1 || ret > 5) {
         return 1;
     }
diff --git util-ironclad-clean/src/pivot_root.c util-ironclad-workdir/src/pivot_root.c
index 0a2f3b7..5c0c8cd 100644
--- util-ironclad-clean/src/pivot_root.c
+++ util-ironclad-workdir/src/pivot_root.c
@@ -19,6 +19,7 @@
 #include <stdlib.h>
 #include <stdio.h>
 #include <string.h>
+#include <unistd.h>
 #include <sys/syscall.h>
 #include <errno.h>
 #include <commons.h>
@@ -44,8 +45,7 @@ int main(int argc, char *argv[]) {
         return 1;
     }
 
-    int ret;
-    SYSCALL4(SYSCALL_PIVOT_ROOT, argv[1], strlen(argv[1]), argv[2], strlen(argv[2]));
+    long ret = syscall(SYS_pivot_root, argv[1], strlen(argv[1]), argv[2], strlen(argv[2]));
     if (ret) {
         perror("pivot_root");
         return 1;
diff --git util-ironclad-clean/src/ps.c util-ironclad-workdir/src/ps.c
index 82f23d7..3bd34ed 100644
--- util-ironclad-clean/src/ps.c
+++ util-ironclad-workdir/src/ps.c
@@ -158,8 +158,7 @@ int main(int argc, char *argv[]) {
     if (print_threads) {
         struct threadinfo *buffer = malloc(50 * sizeof(struct threadinfo));
 
-        long ret, errno;
-        SYSCALL2(SYSCALL_LISTTHREADS, buffer, 50);
+        long ret = syscall(SYS_listthreads, buffer, 50);
         if (ret == -1) {
             return 1;
         } else if (ret > 50) {
@@ -168,15 +167,15 @@ int main(int argc, char *argv[]) {
                 perror("ps: Could not allocate thread info buffer");
                 return 1;
             }
-            SYSCALL2(SYSCALL_LISTTHREADS, buffer, ret);
+            ret = syscall(SYS_listthreads, buffer, ret);
         }
 
         const long count = ret;
         printf("%4s %4s %4s %4s %20s\n", "TID", "NICE", "PRIO", "PID", "ID");
         for (int i = 0; i < count; i++) {
             char id_buf[64];
-            SYSCALL3(SYSCALL_GETTIDID, buffer[i].tid, id_buf, 64);
-            if (ret != 0) {
+            long id_ret = syscall(SYS_gettidid, buffer[i].tid, id_buf, 64);
+            if (id_ret != 0) {
                 strcpy(id_buf, " ");
             }
 
@@ -192,8 +191,7 @@ int main(int argc, char *argv[]) {
         return 1;
     }
 
-    long ret, errno;
-    SYSCALL2(SYSCALL_LISTPROCS, buffer, 50);
+    long ret = syscall(SYS_listprocs, buffer, 50);
     if (ret == -1) {
         return 1;
     } else if (ret > 50) {
@@ -202,7 +200,7 @@ int main(int argc, char *argv[]) {
             perror("ps: Could not allocate process info buffer");
             return 1;
         }
-        SYSCALL2(SYSCALL_LISTPROCS, buffer, ret);
+        ret = syscall(SYS_listprocs, buffer, ret);
     }
 
     if (print_only_this) {
diff --git util-ironclad-clean/src/showmem.c util-ironclad-workdir/src/showmem.c
index e8a2b93..4ab2942 100644
--- util-ironclad-clean/src/showmem.c
+++ util-ironclad-workdir/src/showmem.c
@@ -67,10 +67,9 @@ int main(int argc, char *argv[]) {
         }
     }
 
-    int ret, errno;
     struct mem_info meminfo;
-    SYSCALL1(SYSCALL_MEMINFO, &meminfo);
-    if (ret != 0) {
+    long ret = syscall(SYS_meminfo, &meminfo);
+    if (ret == -1) {
         return 1;
     }
 
diff --git util-ironclad-clean/src/strace.c util-ironclad-workdir/src/strace.c
index 055e831..6d57be9 100644
--- util-ironclad-clean/src/strace.c
+++ util-ironclad-workdir/src/strace.c
@@ -273,13 +273,13 @@ END_WHILE:
         }
     }
 
-    int ret, errno, status;
+    int status;
     uint16_t thread_id;
     struct registers state;
 
-    SYSCALL4(SYSCALL_PTRACE, 1, child, 0, pipes[1]);
+    long ret = syscall(SYS_ptrace, 1, child, 0, pipes[1]);
     if (ret) {
-        fprintf(stderr, "strace: Could not do ptrace: %s\n", strerror(errno));
+        perror("strace: Could not do ptrace");
         return 1;
     }
 
@@ -314,9 +314,10 @@ END_WHILE:
                        fprintf(out, "%d: ", thread_id);
                        print_syscall(out, state);
                        fprintf(out, "\n");
-                       infos[i].is_syscall = state.rax == SYSCALL_EXIT ||
-                                    state.rax == SYSCALL_EXIT_THREAD ||
-                                    state.rax == SYSCALL_EXEC;
+                       // Ironclad syscall numbers: exit=0, exit_thread=31, exec=11
+                       infos[i].is_syscall = state.rax == 0 ||
+                                    state.rax == 31 ||
+                                    state.rax == 11;
                    } else {
                        fprintf(out, "\t%d: ", thread_id);
                        print_error(out, state);
diff --git util-ironclad-clean/src/umount.c util-ironclad-workdir/src/umount.c
index 6a7b6fe..9a18aa7 100644
--- util-ironclad-clean/src/umount.c
+++ util-ironclad-workdir/src/umount.c
@@ -20,8 +20,6 @@
 #include <string.h>
 #include <stdlib.h>
 #include <unistd.h>
-#include <sys/syscall.h>
-#include <math.h>
 #include <sys/mount.h>
 #include <commons.h>
 
@@ -41,7 +39,7 @@ int main(int argc, char *argv[]) {
                 puts("-v              Display version information.");
                 return 0;
             case 'f':
-               flags |= 1;
+               flags |= MNT_FORCE;
                break;
             case 'v':
                puts("umount" VERSION_STR);
