#! /bin/sh

name=mailutils
version=3.21
revision=1
tarball_url="https://ftp.gnu.org/gnu/mailutils/mailutils-${version}.tar.xz"
tarball_blake2b="395da966e7a290a53665a79f7984185cd73583c599d3b7d05a6b4ec1113fcaab5e526a3323cef36e75fa0eb0f26efdfb4f5874d1dbd633ee9a0a025a9e219140"
hostdeps="gcc pkg-config"
deps="core-libs"

prepare() {
    autotools_recursive_regen
}

configure() {
    autotools_configure \
        CFLAGS="$TARGET_CFLAGS -std=gnu17" \
        --disable-python \
        --disable-build-imap4d
}

build() {
    make -j${parallelism} \
        CFLAGS="${TARGET_CFLAGS} -std=gnu17" \
        CXXFLAGS="${TARGET_CXXFLAGS}" \
        LDFLAGS="${TARGET_LDFLAGS}"
}

package() {
    DESTDIR="${dest_dir}" make install

    ln -s mail "${dest_dir}${prefix}"/bin/mailx

    post_package_strip
}
